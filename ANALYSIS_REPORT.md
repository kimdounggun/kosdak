# 플랫폼 분석 보고서 (기술 & 사용자 관점)

## 1. 전체 요약
플랫폼은 **Yahoo Finance -> DB -> AI -> Frontend**로 이어지는 명확한 데이터 파이프라인과 **백테스팅 기반 신뢰도 점수** 시스템을 갖추고 있어 구조적으로 탄탄합니다. 그러나 **데이터 수집의 불안정성(재시도 로직 부재)**과 **단순한 추세 분석 로직**이 신뢰도를 저하시킬 수 있으며, 프론트엔드가 특정 AI 응답 형식에 강하게 결합되어 있어 유지보수가 어렵습니다.

## 2. 문제 목록

| 심각도 | 문제 설명 | 위치 |
| :--- | :--- | :--- |
| **심각** | **데이터 수집 신뢰성 부족**: 외부 API(Yahoo) 호출 실패 시 재시도(Retry) 로직이 없고, 에러 발생 시 로그만 남기고 건너뜀. 데이터 누락 가능성 높음. | `backend/.../candles-collector.worker.ts` |
| **높음** | **단순한 추세 분석 로직**: 최근 10개 캔들의 양봉/음봉 개수만으로 추세를 판단함. 실제 시장의 고점/저점 패턴이나 이평선 기울기를 반영하지 못해 부정확할 수 있음. | `backend/.../ai.service.ts` (`analyzeTrend`) |
| **중간** | **프론트엔드 강결합**: `AiReportViewer`가 특정 JSON 구조와 하드코딩된 색상/텍스트에 의존함. AI 응답 형식이 바뀌면 UI가 깨지거나 수정 비용이 큼. | `frontend/.../AiReportViewer.tsx` |
| **중간** | **UX 인지 비용**: `SymbolCard`의 삭제 버튼이 작고 접근하기 쉬워 실수로 삭제할 위험이 있음. 또한 대시보드에서 데이터 갱신 시점을 직관적으로 알기 어려움. | `frontend/.../SymbolCard.tsx` |
| **낮음** | **에러 메시지 처리**: AI 분석 실패 시 "AI 서비스 연결 실패"라는 정적인 메시지만 반환되어 사용자에게 구체적인 상황(일시적 오류 vs 데이터 부족)을 전달하지 못함. | `backend/.../ai.service.ts` (`generateFallbackReport`) |

## 3. 해결 방법

### 1) 데이터 수집 안정화 (기술)
1.  `axios-retry` 패키지를 도입하여 API 호출 실패 시 지수 백오프(Exponential Backoff)로 3회 이상 재시도하도록 설정.
2.  `collectSymbolData` 내에서 에러 발생 시, 실패한 심볼을 별도 큐(Queue)에 담아 작업 완료 후 재시도하는 로직 추가.

### 2) 추세 분석 로직 고도화 (기술/신뢰도)
1.  `analyzeTrend` 함수를 개선하여 **이동평균선(MA20, MA60)의 기울기**와 **고점/저점(High/Low)의 변화**를 함께 고려하도록 수정.
2.  예: `MA20 > MA60`이고 `현재가 > MA20`일 때만 '상승'으로 판단.

### 3) 프론트엔드 유연성 확보 (기술/유지보수)
1.  `AiReportViewer`에서 하드코딩된 색상/텍스트 매핑을 별도 설정 파일(`constants.ts`)이나 API 응답의 `meta` 데이터로 분리.
2.  JSON 파싱 실패 시 보여줄 'Fallback UI'를 좀 더 친절하게 디자인 (예: "잠시 후 다시 시도해주세요").

### 4) UX 개선 (사용자)
1.  `SymbolCard`의 삭제 버튼을 '편집 모드' 진입 시에만 노출하거나, 롱프레스(모바일)/우클릭(PC) 메뉴로 이동.
2.  카드 상단에 '마지막 업데이트: 5분 전'과 같은 상대적 시간 표시 추가.

## 4. 추가 제안
-   **사용자 피드백 루프**: AI 리포트 하단에 "도움이 되었나요? (좋아요/싫어요)" 버튼을 추가하여, 사용자 피드백을 수집하고 이를 `confidenceScore` 계산에 반영하면 신뢰도를 더욱 높일 수 있습니다.
-   **실시간성 강화**: 현재 5분 주기 폴링 방식인데, 중요 종목에 대해서는 WebSocket을 도입하거나 주기를 단축하여 실시간성을 강화하는 것을 고려해볼 만합니다.
